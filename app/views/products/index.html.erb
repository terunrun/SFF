<% provide(:title, " | 商品一覧") %>
<div class="contents-wrapper">
  <div class="container">
    <h1 class="text-center"><%= t('view.product') %>一覧</h1>
    <div class="row">
      <%= form_tag(products_path, method: :get) do %>
        <div class="form-group">
          <%= text_field_tag :search_name %>
          <%= date_field_tag :search_date %>
          <%= check_box_tag :search_stock %>
          <%= label_tag :search_stock, "在庫ありのみ" %>
        </div>
        <%= submit_tag "検索", :name => nil %>
      <% end %>
    </div>
    <% if !@products.blank? %>
      <div class="row">
        <% @products.each do |product| %>
          <div class="product-area">
            <p>商品名：<%= link_to "#{product.name}", product_path(product.id) %></p>
            <p>販売者：<%= link_to "#{product.user.name}", user_path(product.user.id) %></p>
            <p>価格：<%= product.price %></p>
            <% if product.stock != 0 %>
              <p>残数：<%= product.stock %></p>
            <% else %>
              <p style="color:red">現在販売されていません。</p>
            <% end %>
            <% if product.image? %>
              <%= image_tag product.image.url %>
            <% else %>
              <%= image_tag "no_image.jpg", width:"200px", height:"200px", style:" border: 1px solid lightgray"%>
            <% end %>
          </div>
        <% end %>
      </div>
      <div class="row">
        <div class="paginate-area">
          <%= paginate @products %>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 col-md-offset-3 text-center">
          <%= link_to "CSV形式でダウンロード", products_path(format: :csv) %>
        </div>
      </div>
    <% else %>
      <div class="row">
        <p class="text-center">商品がありません</p>
      </div>
    <% end %>
  </div>
</div>
